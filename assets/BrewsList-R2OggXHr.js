import{r as a,v as _,K as p,n as e,O as c,P as z}from"./index-CNX0uGbz.js";import{v as n,z as v,A as N,w as I,x as M,y as C}from"./chunk-O24IAYCG-C7X2ncAB.js";import{c as o}from"./chunk-IHOGUXIG-DF624XCl.js";import{s as D}from"./chunk-EUS52Q2W-BpCiSDIa.js";import"./useFormReset-BmW2zeWF.js";function V(){const[m,w]=a.useState([]),[d,x]=a.useState([]),[t,h]=a.useState(""),[l,f]=a.useState(""),[r,u]=a.useState([1,5]);a.useEffect(()=>{Promise.all([_(),p()]).then(([s,i])=>{w(s),x(i)})},[]);const B=a.useMemo(()=>Array.from(new Set(d.map(s=>s.method).filter(Boolean))).sort(),[d]),j=a.useMemo(()=>d.filter(s=>!(t&&s.method!==t||l&&!s.beanIds.includes(Number(l))||s.rating&&(s.rating<r[0]||s.rating>r[1]))),[d,t,l,r]),y=s=>s.map(i=>{var g;return(g=m.find(b=>b.id===i))==null?void 0:g.name}).filter(Boolean).join(", "),S=async s=>{if(!confirm("Are you sure you want to delete this brew?"))return;await z(s);const i=await p();x(i)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"My Brews"}),e.jsx(c,{to:"/add-brew",search:{fromId:void 0},children:e.jsx(n,{as:"div",color:"success",variant:"solid",className:"text-white",children:"Add New Brew"})})]}),e.jsxs("div",{className:"flex gap-4 flex-wrap items-center p-4 bg-content1 rounded-medium shadow-small",children:[e.jsx(v,{label:"Method",placeholder:"Select a method",selectedKeys:t?[t]:[],onChange:s=>h(s.target.value),className:"max-w-xs",size:"sm",children:B.map(s=>e.jsx(N,{children:s},s))}),e.jsx(v,{label:"Bean",placeholder:"Select a bean",selectedKeys:l?[l]:[],onChange:s=>f(s.target.value),className:"max-w-xs",size:"sm",children:m.map(s=>e.jsx(N,{children:s.name},String(s.id)))}),e.jsx("div",{className:"w-full max-w-xs px-2",children:e.jsx(D,{label:"Rating Range",step:1,minValue:1,maxValue:5,defaultValue:[1,5],value:r,onChange:s=>u(s),className:"max-w-md",size:"sm"})}),(t||l||r[0]!==1||r[1]!==5)&&e.jsx(n,{color:"danger",variant:"light",onPress:()=>{h(""),f(""),u([1,5])},children:"Clear Filters"})]}),j.length===0?e.jsx("p",{className:"text-default-500",children:"No brews found."}):e.jsx("div",{className:"grid gap-4",children:j.map(s=>e.jsxs(I,{className:"w-full",children:[e.jsxs(M,{className:"flex flex-col sm:flex-row justify-between items-start pb-0 gap-4 sm:gap-0",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("h3",{className:"text-lg font-bold",children:s.method}),e.jsx("p",{className:"text-small text-default-500",children:new Date(s.date).toLocaleDateString()}),s.rating&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"text-yellow-500",children:"★"}),e.jsxs("span",{className:"text-small font-medium",children:[s.rating,"/5"]})]})]}),e.jsxs("div",{className:"flex gap-2 w-full sm:w-auto sm:justify-end",children:[e.jsx(c,{to:"/edit-brew/$brewId",params:{brewId:String(s.id)},children:e.jsx(n,{size:"sm",color:"primary",variant:"flat",as:"div",children:"Edit"})}),e.jsx(c,{to:"/add-brew",search:{fromId:s.id},children:e.jsx(n,{size:"sm",color:"success",variant:"flat",as:"div",children:"Duplicate"})}),e.jsx(n,{onPress:()=>S(s.id),size:"sm",color:"danger",variant:"flat",children:"Delete"})]})]}),e.jsxs(C,{children:[e.jsxs("p",{className:"text-small text-default-500 mb-2",children:[e.jsx("strong",{children:"Beans:"})," ",y(s.beanIds)]}),e.jsxs("div",{className:"flex gap-2 mb-2",children:[e.jsxs(o,{size:"sm",variant:"flat",children:[s.beanWeight,"g beans"]}),e.jsxs(o,{size:"sm",variant:"flat",children:[s.waterVolume,"ml water"]}),e.jsxs(o,{size:"sm",variant:"flat",children:[s.waterTemp,"°C"]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-small",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Grinder:"})," ",s.grinder]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Setting:"})," ",s.grindSize]})]})]})]},s.id))})]})}export{V as BrewsList};
