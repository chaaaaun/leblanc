import{r as t,v as y,n as s,O as j,ab as P,P as S,ac as z}from"./index-DmQQhyBz.js";import{v as c,z as m,A as d,w as O,x as A,y as M}from"./chunk-O24IAYCG-5qN92RUs.js";import{i as F}from"./chunk-SSA7SXE4-BNG-TA7H.js";import{c as w}from"./chunk-IHOGUXIG-BmviU1Zv.js";import"./useFormReset-21_MpbOM.js";function K(){const[a,f]=t.useState([]),[r,u]=t.useState(""),[o,x]=t.useState(""),[l,h]=t.useState(""),[i,g]=t.useState("");t.useEffect(()=>{y().then(f)},[]);const N=t.useMemo(()=>Array.from(new Set(a.map(e=>e.roastery).filter(Boolean))).sort(),[a]),v=t.useMemo(()=>Array.from(new Set(a.map(e=>e.processingMethod).filter(Boolean))).sort(),[a]),p=t.useMemo(()=>a.filter(e=>{var n;return!(r&&e.type!==r||o&&!((n=e.countryOfOrigin)!=null&&n.toLowerCase().includes(o.toLowerCase()))||l&&e.processingMethod!==l||i&&e.roastery!==i)}),[a,r,o,l,i]),B=async e=>{if(!confirm("Are you sure you want to delete this bean?"))return;const n=await P(e);if(n.length>0){const b=`This bean is used in ${n.length} brew(s). Deleting it will also delete these brews. Proceed?`;if(!confirm(b))return;await Promise.all(n.map(C=>S(C.id)))}await z(e);const _=await y();f(_)};return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("h2",{className:"text-2xl font-bold",children:"My Beans"}),s.jsx(j,{to:"/add",children:s.jsx(c,{as:"div",color:"primary",variant:"solid",children:"Add New Bean"})})]}),s.jsxs("div",{className:"flex gap-4 flex-wrap items-center p-4 bg-content1 rounded-medium shadow-small",children:[s.jsxs(m,{label:"Type",placeholder:"All Types",selectedKeys:r?[r]:[],onChange:e=>u(e.target.value),className:"max-w-xs",size:"sm",children:[s.jsx(d,{children:"Single Origin"},"single_origin"),s.jsx(d,{children:"Blend"},"blend")]}),s.jsx(F,{placeholder:"Filter Country...",value:o,onValueChange:x,className:"max-w-xs",size:"sm"}),s.jsx(m,{label:"Roastery",placeholder:"All Roasteries",selectedKeys:i?[i]:[],onChange:e=>g(e.target.value),className:"max-w-xs",size:"sm",children:N.map(e=>s.jsx(d,{children:e},e))}),s.jsx(m,{label:"Process",placeholder:"All Processes",selectedKeys:l?[l]:[],onChange:e=>h(e.target.value),className:"max-w-xs",size:"sm",children:v.map(e=>s.jsx(d,{children:e},e))}),(r||o||i||l)&&s.jsx(c,{color:"danger",variant:"light",onPress:()=>{u(""),x(""),g(""),h("")},children:"Clear Filters"})]}),p.length===0?s.jsx("p",{className:"text-default-500",children:"No beans found."}):s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:p.map(e=>s.jsxs(O,{className:"w-full",children:[s.jsxs(A,{className:"flex justify-between items-start pb-0",children:[s.jsx("h3",{className:"text-lg font-bold",children:e.name}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(j,{to:"/edit/$beanId",params:{beanId:String(e.id)},children:s.jsx(c,{size:"sm",color:"primary",variant:"flat",as:"div",children:"Edit"})}),s.jsx(c,{onPress:()=>B(e.id),size:"sm",color:"danger",variant:"flat",children:"Delete"})]})]}),s.jsxs(M,{children:[s.jsx("p",{className:"text-small text-default-500 mb-2",children:e.roastery}),s.jsxs("div",{className:"flex gap-2 mb-2 flex-wrap",children:[s.jsx(w,{size:"sm",variant:"flat",color:"default",children:e.type==="single_origin"?"Single Origin":"Blend"}),e.countryOfOrigin&&s.jsx(w,{size:"sm",variant:"flat",color:"primary",children:e.countryOfOrigin})]}),s.jsxs("p",{className:"text-small mt-2",children:[s.jsx("strong",{children:"Notes:"})," ",e.tastingNotes]})]})]},e.id))})]})}export{K as BeansList};
